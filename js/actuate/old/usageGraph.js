!function(t,a){t.fn.usageGraph=function(){var s=t(this)[0],i={width:400,height:200,svg:null,scaleX:null,scaleY:null,the_max:null,line:null,graph:this,init:function(){this.svgw=this.width,this.svgh=this.height,this.svg=a.select(s).attr("viewBox","0 0 "+this.svgw+" "+this.svgh),t(this.svg.node().parentNode).attr("style","padding-top:"+100*this.svgh/this.svgw+"%"),this.svg.append("rect").attr("class","graph--background").attr("x",0).attr("y",0).attr("width",this.width).attr("height",this.height),this.scaleX=a.scale.linear().domain([0,31]).range([0,this.width]),this.scaleY=a.scale.linear().domain([0,this.the_max]).range([this.height,0])},plotGraph:function(t,s){var i=this.scaleX,r=this.scaleY,h=a.svg.area().x(function(t){return i(t.day)}).y0(this.height).y1(function(t){return r(t.num)}).interpolate("line");this.svg.append("path").datum(t).attr("class",s).attr("d",h)},addXAxis:function(){var t=a.svg.axis().scale(this.scaleX).orient("bottom").tickSize(-this.height).ticks(32);this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+this.height+")").call(t)},addLine:function(t,a){var s=this.scaleY(t),i=this.svg.append("g");return i.append("line").attr("x1",0).attr("x2",this.width).attr("y1",s).attr("y2",s),i.append("text").attr("transform","translate("+this.width+" "+(s-3)+")").text(a),i}},r=function(){return{data:[],max:null,prepareData:function(t){t.unshift(0);for(var s=0,i=0;i<t.length;i++)s+=t[i],this.data[i]={day:i,num:s};this.max=a.max(this.data,function(t){return t.num})}}},h=[80,460,100],h=[80,460,100,230,0,10,300,800],e=r();e.prepareData(h);var n=[60,514,111,240,16,34,392,823,365,469,458,482,883,241,398,478,283,292,582,761,242,371,494,343,405,488,637,482,447,260,319];n.reverse();var l=r();l.prepareData(n),i.the_max=1.1*a.max([e.max,l.max]),i.init(),i.plotGraph(l.data,"graph--area--prev"),i.addLine(l.max,"last month").attr("class","graph graph--previous"),i.plotGraph(e.data,"graph--area"),i.addLine(e.max,"so far").attr("class","graph graph--sofar"),i.addLine(8900,"average Â£23.30").attr("class","graph graph--average").attr("stroke-dasharray","2,2"),i.addXAxis()}}(jQuery,d3);